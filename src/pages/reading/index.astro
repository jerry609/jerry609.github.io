---
import PageLayout from '../../layouts/CommonPage.astro'
import { readings } from '@/data/readings'

const inboxItems = readings.filter((i) => i.status === 'inbox')
const readingItems = readings.filter((i) => i.status === 'reading')
const doneItems = readings.filter((i) => i.status === 'done')
---

<PageLayout title='Reading List'>
  <div class='max-w-3xl mx-auto'>
    <div class='mb-8'>
      <h1 class='text-3xl font-bold mb-2'>Input Stream</h1>
      <p class='text-muted-foreground'>
        Signal vs Noise. A buffer for the mind.
      </p>
    </div>

    {/* Inbox Section - High Density */}
    <section class='mb-12'>
      <div class='flex items-center gap-2 mb-4'>
        <h2 class='text-xl font-semibold'>Inbox</h2>
        <span class='px-2 py-0.5 rounded-full bg-primary/10 text-primary text-xs font-medium'>
          {inboxItems.length}
        </span>
      </div>
      
      <div class='space-y-2'>
        {inboxItems.map((item) => (
          <a 
            href={item.url}
            target='_blank'
            rel='noopener noreferrer'
            class='block group p-3 rounded-lg border bg-card hover:border-primary/50 transition-colors'
          >
            <div class='flex items-center justify-between'>
              <span class='font-medium group-hover:text-primary transition-colors line-clamp-1'>
                {item.title}
              </span>
              <span class='text-xs text-muted-foreground shrink-0 ml-4 font-mono'>
                {item.date}
              </span>
            </div>
            {item.tags && item.tags.length > 0 && (
              <div class='mt-1 flex gap-2'>
                {item.tags.map(tag => (
                  <span class='text-xs text-muted-foreground/60'>#{tag}</span>
                ))}
              </div>
            )}
          </a>
        ))}
        {inboxItems.length === 0 && (
          <div class='text-center py-8 text-muted-foreground bg-muted/30 rounded-lg border border-dashed'>
            Inbox zero. Peace of mind.
          </div>
        )}
      </div>
    </section>

    {/* Active Reading Section - Expanded Cards */}
    <section class='mb-12'>
      <h2 class='text-xl font-semibold mb-4'>Active Reading</h2>
      <div class='grid gap-4'>
        {readingItems.map((item) => (
          <div class='p-5 rounded-xl border bg-card/50 backdrop-blur-sm'>
            <a 
              href={item.url}
              target='_blank' 
              rel='noopener noreferrer'
              class='text-lg font-semibold hover:text-primary transition-colors block mb-2'
            >
              {item.title}
            </a>
            {item.note && (
              <div class='text-sm text-muted-foreground mb-3 leading-relaxed border-l-2 pl-3 py-1'>
                {item.note}
              </div>
            )}
            <div class='flex items-center justify-between text-xs text-muted-foreground'>
              <div class='flex gap-2'>
                {item.tags?.map(tag => (
                  <span class='px-1.5 py-0.5 rounded bg-secondary text-secondary-foreground'>
                    {tag}
                  </span>
                ))}
              </div>
              <span class='font-mono opacity-50'>{item.date}</span>
            </div>
          </div>
        ))}
        {readingItems.length === 0 && (
           <div class='text-sm text-muted-foreground italic'>Nothing active right now. Pick something from the inbox.</div>
        )}
      </div>
    </section>

    {/* Archive Section - Simple List */}
    <section>
      <h2 class='text-xl font-semibold mb-4'>Archive</h2>
      <div class='grid gap-3 sm:grid-cols-2'>
        {doneItems.map((item) => (
          <a 
            href={item.url}
            target='_blank'
            rel='noopener noreferrer'
            class='p-4 rounded-lg border border-transparent bg-muted/40 hover:bg-muted/80 hover:border-border transition-all group'
          >
            <div class='font-medium mb-1 group-hover:text-primary transition-colors line-clamp-2 h-[3rem]'>
              {item.title}
            </div>
            <div class='flex items-center justify-between mt-2'>
               <div class='flex gap-1.5 overflow-hidden'>
                 {item.tags?.slice(0, 2).map(tag => (
                   <span class='text-[10px] uppercase tracking-wider text-muted-foreground/70'>
                     {tag}
                   </span>
                 ))}
               </div>
               {/* <span class='text-xs text-muted-foreground/40 font-mono'>{item.date}</span> */}
            </div>
          </a>
        ))}
      </div>
    </section>
  </div>
</PageLayout>
